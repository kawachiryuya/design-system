# フォーカス管理

## メタ情報
- カテゴリ: 基盤原則 > アクセシビリティ
- 適用範囲: Atom〜Page
- ステータス: Approved
- 最終更新: 2024-01-15

## 原則の定義

**フォーカスを適切に管理し、ユーザーが現在位置を常に認識できるようにする**

## フォーカスインジケーター

### 要件

- **視認性**: 2px境界線、コントラスト比3:1以上（WCAG 2.1）
- **明確性**: 要素全体を囲む、または明確なアウトライン
- **一貫性**: すべてのフォーカス可能要素で統一

### 実装

```css
/* 推奨 */
button:focus-visible {
  outline: 2px solid blue;
  outline-offset: 2px;
}

/* 避ける */
button:focus {
  outline: none; /* フォーカスが見えなくなる */
}
```

## フォーカストラップ

### モーダル・ダイアログ

モーダル内にフォーカスを閉じ込める。

**要件**:
1. モーダル表示時、最初の要素にフォーカス
2. Tabで最後の要素に到達 → 最初の要素へ
3. Shift+Tabで最初の要素から → 最後の要素へ
4. Escapeでモーダルを閉じる
5. 閉じた後、元の要素にフォーカス復帰

→ 実装詳細は [Modal コンポーネント](../../../components/organisms/modal.md) 参照

## 動的コンテンツ

### 原則

- コンテンツ追加時、適切な要素にフォーカス
- 削除時、論理的な次の要素にフォーカス
- ページ遷移時、先頭またはメインコンテンツにフォーカス

### 例

```typescript
// 項目削除後
handleDelete(itemId) {
  deleteItem(itemId);
  // 次の項目、または前の項目にフォーカス
  focusNextItem(itemId);
}
```

## スキップリンク

ページ先頭に「メインコンテンツへスキップ」を配置。

```html
<a href="#main" class="skip-link">
  メインコンテンツへスキップ
</a>
```

## 関連ドキュメント

- [Keyboard Navigation](./keyboard-navigation.md)
- [States](../../interaction/states/overview.md)

## バージョン履歴

| 日付 | バージョン | 変更内容 | 変更理由 |
|------|-----------|----------|----------|
| 2024-01-15 | 1.0.0 | 初版作成 | accessibility.mdから分離 |
