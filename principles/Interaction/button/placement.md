# アクション配置の原則

## メタ情報
- カテゴリ: インタラクション原則
- 適用範囲: Molecule〜Page
- ステータス: Approved
- 最終更新: 2024-01-15

## 原則の定義

**アクションボタンは、視線の流れとPrimaryの視認性に基づいて、一貫した位置に配置する**

ボタン配置は、西洋言語圏の読み順（左から右、上から下）、視覚的ヒエラルキー、配置方向ごとの視認性、モバイルでの親指の可動域に基づいて体系的に決定されます。

## 背景と目的

### なぜこの原則が必要か

一貫性のない配置は以下の問題を引き起こします：

- **誤操作の増加**: 位置が毎回変わると、誤って破壊的操作を実行
- **認知負荷**: どこにボタンがあるか毎回探す必要がある
- **完了率の低下**: Primaryアクションが見つけにくいとタスク放棄
- **学習の妨げ**: 位置が異なると操作方法を学習できない

### 設計の基礎

1. **視線の流れ**: 左→右、上→下
2. **Primaryの視認性**: 配置方向において最も目に入りやすい位置にPrimary配置
   - 横並び: 読み順の終点（右端）
   - 縦並び: 視線が最初に届く位置（上端）
3. **親指の可動域**: モバイルでは右下・上部が到達しやすい
4. **プラットフォーム慣習**: 主要OS・サービスとの整合性

## 前提: ボタンの優先度

配置ルールを適用する前に、ボタンを以下の3つに分類します：

- **Primary**: 主要アクション（保存、送信、次へ）
- **Secondary**: 補助アクション（キャンセル、戻る）
- **Tertiary**: その他のアクション（詳細、ヘルプ）

→ 詳細は [Button Priority](./button-priority.md) 参照

## 基本配置ルール

### 横並び配置（デスクトップ、タブレット横向き）

**Primary は右、Secondary は左**

```
[ Secondary ]  [ Primary ]
```

#### 設計根拠

1. **視線の終点への配置**: 左→右の読み順において、視線が最後に到達する右端にPrimary
2. **プラットフォーム慣習**: macOS、Windows、主要Webサービス
3. **読み順との整合性**: 左から読み進めて右端で決定
4. **誤操作の防止**: 自然に目が行く右側にPrimary

#### 3つ以上のボタン

優先度の低い順に左から配置

```
[ Tertiary ]  [ Secondary ]  [ Primary ]
```

**間隔**: 12px（gap-3）または 16px（gap-4）

### 縦並び配置（モバイル、狭い画面）

**Primary は上、Secondary は下**

```
[ Primary    ]
[ Secondary  ]
```

#### 設計根拠

1. **最も目に入りやすい位置への配置**: 上→下の視線の流れにおいて、最初に目が届く上端にPrimary
2. **重要度の直感的な表現**: 上＝重要という認知パターンと一致
3. **誤タップ防止**: 破壊的アクションを下に置くことで安全側に非対称化

#### 間隔

8px（gap-2）または 12px（gap-3）

### レスポンシブ対応

画面幅に応じて自動切り替え

```
モバイル（縦）:       デスクトップ（横）:
[ Primary    ]        [ Secondary ] [ Primary ]
[ Secondary  ]
```

**ブレークポイント**: 640px（sm）を推奨

## 特殊ケース

### 破壊的アクション（削除確認等）

**原則**: 安全な選択（キャンセル）をPrimaryとする

```
削除確認:
[ 削除(Secondary) ] [ キャンセル(Primary) ]
```

**理由**:
- 誤操作による重大な損失を防ぐ
- 安全な選択を目立たせる
- ユーザーに考える時間を与える

→ 詳細は [Button Priority](./button-priority.md) の「破壊的アクションの扱い」参照

### 進行方向を示すアクション

マルチステップフォーム等で、視覚的に方向を示す

```
[ ← 戻る ]              [ 次へ → ]
```

**配置**: 
- 戻る: 左端
- 次へ: 右端
- 中間アクション（下書き保存等）: 中央

```
[ ← 戻る ]  [ 下書き保存 ]  [ 次へ → ]
```

### 1つのアクションのみ

**配置**: 右揃え（デスクトップ）、全幅（モバイル）

```
デスクトップ:                [ OK ]
モバイル:     [ OK                ]
```

### 同等の重要度（どちらもSecondary）

両方を控えめなスタイルで、コンテキストで判断を促す

```
[ オプションA ] [ オプションB ]
```

**推奨**: 可能な限り片方をPrimaryにする

## 配置の揃え方

### 右揃え vs 左揃え

**推奨**: 右揃え

```
                    [ Secondary ] [ Primary ]
```

**理由**:
- 視線の終点に配置
- フォームの入力後、自然に目が行く
- プラットフォーム慣習

**例外**: 全幅レイアウトの場合

```
[ Secondary ]                    [ Primary ]
```

### 中央揃え

**使用場面**: モーダル、単独のCTA

```
            [ Primary ]
```

**避けるべき**: 複数ボタンの中央揃え（どちらが重要か不明確）

## モバイル固有の考慮

### 親指の可動域

- **右利きユーザー**: 右下、上部が到達しやすい
- **左利きユーザー**: 設定で左右反転を検討

### 全幅ボタン

モバイルではボタンを全幅にすることで、タップしやすくする

```
[ Primary（全幅）      ]
[ Secondary（全幅）    ]
```

**最小高さ**: 44px（タップ領域確保）

### Floating Action Button（FAB）

**配置**: 右下固定（または左下）

```
                           [+]
```

**用途**: 主要な作成アクション

→ 実装詳細は [FAB](../../components/atoms/fab.md) 参照

## 文脈別のクイックリファレンス

詳細な文脈別パターン（モーダル、フォーム、カード等）は、以下を参照：

### モーダル
- 標準: 右揃え、横並び（デスクトップ）
- 削除確認: 安全な選択をPrimary

→ 実装詳細は [Modal](../../components/organisms/modal.md) 参照

### フォーム
- 単一カラム: 右揃え、フォームの最後
- マルチステップ: 戻る（左）、次へ（右）

→ 実装詳細は [Form](../../components/organisms/form.md) 参照

### カード
- 横幅に応じて横並び/縦並び
- 右揃えまたは全幅

→ 実装詳細は [Card](../../components/organisms/card.md) 参照

### テーブル
- 行アクション: 右端
- アイコンボタンで省スペース

→ 実装詳細は [Table](../../components/organisms/table.md) 参照

## 実装パターン

### 基本的な横並び

```html
<!-- 右揃え、横並び -->
<div class="flex justify-end gap-3">
  <button variant="secondary">キャンセル</button>
  <button variant="primary">保存</button>
</div>
```

### レスポンシブ（縦↔横切り替え）

```html
<!-- モバイル: 縦並び、Primary上 -->
<!-- デスクトップ: 横並び、Primary右 -->
<div class="flex flex-col-reverse sm:flex-row gap-3 sm:justify-end">
  <button variant="secondary" class="w-full sm:w-auto">
    キャンセル
  </button>
  <button variant="primary" class="w-full sm:w-auto">
    保存
  </button>
</div>
```

**Note**: `flex-col-reverse` により、DOM順序を変えずに視覚順序を逆転

→ 詳細な実装は [ButtonGroup](../../components/molecules/button-group.md) 参照

## 測定方法

### チェックリスト

- [ ] 横並び: Primary右、Secondary左
- [ ] 縦並び: Primary上、Secondary下
- [ ] 破壊的アクション: 安全な選択をPrimary
- [ ] 優先度順に配置（低→高）
- [ ] レスポンシブ対応（横↔縦切り替え）
- [ ] 適切な間隔（12-16px）
- [ ] モバイルで44px以上の高さ

### ユーザビリティテスト

- **タスク完了率**: 一貫した配置で向上
- **誤操作率**: 間違ったボタンのクリック回数
- **時間計測**: アクション実行までの時間
- **ヒートマップ**: Primaryへの視線集中度

## 関連原則

- **[Button Priority](./button-priority.md)**: ボタンの優先度分類（前提知識）
- **[Hierarchy](../foundation/hierarchy.md)**: 視覚的ヒエラルキー全般
- **[Consistency](../foundation/consistency.md)**: 配置パターンの一貫性
- **[Accessibility](../foundation/accessibility.md)**: キーボード操作、フォーカス管理

## 関連コンポーネント

各コンテキストでの具体的な実装例：

### Molecules
- **ButtonGroup**: ボタングループの配置実装

### Organisms
- **Modal**: モーダルフッター
- **Form**: フォーム送信ボタン
- **Wizard**: マルチステップフォーム
- **Card**: カード内アクション
- **Table**: テーブル行アクション

## バージョン履歴

| 日付 | バージョン | 変更内容 | 変更理由 |
|------|-----------|----------|----------|
| 2024-01-15 | 1.0.0 | 初版作成 | アクション配置の体系化 |
| 2024-01-15 | 2.0.0 | ドキュメント簡潔化、button-priority.mdへの分割 | 役割の明確化、可読性向上 |
| 2026-02-20 | 2.1.0 | 設計の基礎・横並び・縦並びの設計根拠を整合 | 「終点にPrimary」が縦並びと概念的に矛盾していたため、「最も目に入りやすい位置にPrimary」に統一 |
