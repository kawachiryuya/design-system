# 進捗表示

## メタ情報
- カテゴリ: インタラクション原則 > Feedback
- 適用範囲: Atom〜Page
- ステータス: Approved
- 最終更新: 2024-02-17

## 原則の定義

**完了までの見通しを示し、ユーザーが「あとどれくらいか」を把握できるようにする**

単なるローディング表示と違い、進捗表示は「どのくらい進んだか」という情報を加えます。完了までの見通しが見えることで、待機中の不安を大きく軽減できます。

## スピナーではなく進捗表示を使う基準

```
スピナーで十分: 数秒以内の処理、進捗の計測が困難
進捗表示が必要: 10秒を超える処理、ステップが明確な処理

目安:
〜3秒  → スピナー
3〜10秒 → スピナー or プログレスバー
10秒以上 → プログレスバー or ステップ表示
```

## 2つのパターン

### 1. プログレスバー（Progress Bar）

**用途**: ファイルアップロード・ダウンロード、長時間の処理

#### 確定的プログレスバー（割合が分かる場合）

```
ファイルアップロード:
[████████░░░░░░░░░░░░] 42%  3.2 MB / 7.6 MB
```

- 進捗率（%）を数値でも表示
- 可能なら残り時間や残りサイズも表示
- 100%になってからすぐ消さず、完了メッセージを表示

#### 不確定プログレスバー（割合が不明な場合）

```
処理中:
[━━━━━━━━━━━━━━━━━━━━] ← 往復アニメーション
```

- 割合は表示しない
- 「処理中」などのラベルを付ける
- 終了時間の目安も付けられる場合は付ける

### 2. ステップ表示（Step Indicator）

**用途**: 多段階のフロー（登録・購入・申込等）

```
水平ステップ（デスクトップ）:
① 入力  ──  ② 確認  ──  ③ 完了
[完了]       [現在]       [未完]

垂直ステップ（モバイル / 複雑なフロー）:
✓ アカウント情報
✓ 住所情報
● 支払い方法  ← 現在のステップ
○ 確認
○ 完了
```

#### ステップ表示のデザイン原則

- **現在のステップ**: 最も目立つ（ブランドカラー・太字）
- **完了したステップ**: チェックアイコン + グレーアウト
- **未完のステップ**: 控えめな表示
- **クリッカブルか**: 完了済みステップは戻れる場合のみクリッカブルに

## プログレスバーの仕様

### サイズ

```
高さ:
  標準: 8px（汎用）
  細型: 4px（コンパクトな表示）
  太型: 16px（強調が必要な場合）

角丸: 高さの1/2（例: 8pxなら4px）
```

### 色

```
トラック（背景）: neutral-100
バー（進捗）: brand-600（通常）
              success-600（完了時）
              error-600（エラー時）
```

### アニメーション

- 進捗の変化: ease-out（自然な減速）
- 不確定バー: linear（一定速度の往復）
- 完了時: success色へのトランジション（300ms）

## アクセシビリティ

```html
<!-- 確定的プログレスバー -->
<div
  role="progressbar"
  aria-valuenow="42"
  aria-valuemin="0"
  aria-valuemax="100"
  aria-label="ファイルアップロード"
>
  <div style="width: 42%"></div>
</div>
<span>42% 完了（3.2 MB / 7.6 MB）</span>

<!-- 不確定プログレスバー -->
<div
  role="progressbar"
  aria-label="処理中"
  aria-valuetext="処理中です。しばらくお待ちください"
>
  <!-- 往復アニメーション -->
</div>

<!-- ステップ表示 -->
<nav aria-label="購入手続きのステップ">
  <ol>
    <li aria-current="false">入力（完了）</li>
    <li aria-current="step">確認（現在）</li>
    <li>完了</li>
  </ol>
</nav>
```

- `role="progressbar"` + `aria-valuenow/min/max`: 進捗をスクリーンリーダーに伝える
- `aria-current="step"`: 現在のステップを示す

## キャンセルの提供

長時間処理には必ずキャンセル手段を提供する。

```
✅ 良い例:
[████████░░░░░░░░░░░░] 42%
[ キャンセル ]

❌ 悪い例:
キャンセルできないまま3分待たせる
```

ローディング中でも、キャンセルボタンはdisabledにしない。

→ [Loading Indicators](./loading-indicators.md) 参照

## チェックリスト

- [ ] 10秒以上の処理に進捗表示
- [ ] 割合が分かる場合は数値も表示
- [ ] キャンセル手段を提供
- [ ] role="progressbar" / aria-current を設定
- [ ] 完了時に成功フィードバック（トースト等）を表示

## 関連ドキュメント

- [Overview](./overview.md)
- [Loading Indicators](./loading-indicators.md): 進捗不明のローディング
- [Toast Notifications](./toast-notifications.md): 完了通知

## バージョン履歴

| 日付 | バージョン | 変更内容 | 変更理由 |
|------|-----------|----------|----------|
| 2024-02-17 | 1.0.0 | 初版作成 | Phase 2 |
